!function(){"use strict";function softGrid($filter,$base64,$timeout,$compile){return{restrict:"E",replace:!0,scope:{data:"=",cols:"=",width:"=",actions:"=",hide:"=",subgrid:"=",template:"=",sgControls:"=",sgMenu:"=",sgStore:"="},templateUrl:"softgrid.html",link:function(scope,element){var enableLog=!1;scope.loading=!1,scope.container=$(element[0]).find(".softgrid-container")[0],scope.configuration=$(element[0]).find(".softgrid-configuration")[0],scope.sg_currentPage=1,scope.sg_linesPerPageInput=10,scope.sg_linesPerPage=10,scope.sg_orderBy="",scope.sg_filterSearch="",scope.larguraColunaControles=0,scope.sg_selected=!1,scope.sg_checked=!1,scope.filteredData=[],scope.sg_filter="",scope.sg_cols=[];var firstLoad=!0;function _getFilteredData(){if(enableLog&&console.log("getFilteredData"),scope.filteredData=scope.data,""===scope.sg_filter||null===scope.sg_filter||angular.isUndefined(scope.sg_filter))scope.sg_sort({item:scope.sg_orderBy},scope.sg_orderByColIndex,!0);else{var n=scope.cols.filter(function(e){return e.checked});n.length<=0&&(n=scope.sg_cols),scope.filteredData=scope.filteredData.filter(function(e){var o,s=!1;for(o=0;o<n.length;o++)if(("text"===n[o].type||"html"===n[o].type||"date"===n[o].type||!angular.isDefined(n[o].type))&&n[o].item&&"string"!=typeof n[o].item){var a=n[o].item(e);if(null!=a){"string"!=typeof a&&(a=a.toString()),a=removeAccents(a);var t=removeAccents(scope.sg_filter);if(-1<a.indexOf(t)){s=!0;break}}}return s}),scope.sgControls&&angular.isDefined(scope.sgControls.filtered)&&(scope.sgControls.filtered=scope.filteredData),scope.sg_sort({item:scope.sg_orderBy},scope.sg_orderByColIndex,!0)}}function removeAccents(e){if(!e)return e;e=e.toUpperCase();var o,s={a:/[\xE0-\xE6]/g,e:/[\xE8-\xEB]/g,i:/[\xEC-\xEF]/g,o:/[\xF2-\xF6]/g,u:/[\xF9-\xFC]/g,c:/\xE7/g,n:/\xF1/g},a=[["Á","A"],["À","A"],["Â","A"],["Ã","A"],["É","E"],["È","E"],["Ê","E"],["Í","I"],["Ì","I"],["Î","I"],["Ó","O"],["Ò","O"],["Ô","O"],["Õ","O"],["Ú","U"],["Ù","U"],["Û","U"]];for(var t in s){var n=s[t];e=e.replace(n,t)}for(o=0;o<a.length;o++)e=e.replace(a[o][0],a[o][1]);return e.toUpperCase()}function createTable(){var a="<table border='1' cellpadding='5'>",e=0;a+="<tr bgcolor='orange'>";var o,s=null;for(e=0;e<scope.cols.length;e++)"subgrid"!=scope.cols[e].type?angular.isFunction(scope.cols[e].item)&&(a+="<td><b>"+scope.cols[e].title+"</b></td>"):s=scope.cols[e].title;for(null!=s&&(a+="<td align='center'><b>"+s+"</b>"),a+="</tr>",e=0;e<scope.data.length;e++){var t=null;for(a+="<tr valign='top'>",o=0;o<scope.cols.length;o++)if("subgrid"!=scope.cols[o].type){var n="";scope.data[e]&&(n=angular.isFunction(scope.cols[o].item)?scope.cols[o].item(scope.data[e]):scope.data[e][scope.cols[o].propriedade]),n||(n=" - "),angular.isString(n)&&(n=removerCaracteresInvalidos(n)),angular.isFunction(scope.cols[o].item)&&(a+="<td>",a+=n,a+="</td>")}else t=scope.cols[o];if(null!=t){var r=t.cols,c=t.item(scope.data[e]);0<c.length&&(a+="<td bgcolor='#F6F6F6'>",a+="<table border='1'>",a+="<tr>",angular.forEach(r,function(e){a+="<td><b>",a+=e.title,a+="</b></td>"}),a+="</tr>",angular.forEach(c,function(s){a+="<tr>",angular.forEach(r,function(e){var o="";s&&(o=angular.isFunction(e.item)?e.item(s):s[e.propriedade]),o||(o=" - "),angular.isString(o)&&(o=removerCaracteresInvalidos(o)),a+="<td>",a+=o,a+="</td>"}),a+="</tr>"}),a+="</table>",a+="</td>")}a+="</tr>"}return a+="</table>"}function _atualizarPaginacao(){if(scope.data){enableLog&&console.log("atualizarPaginacao"),scope.totalPages=scope.filteredData.length/scope.sg_linesPerPage,scope.totalPages=scope.totalPages>parseInt(scope.totalPages)?parseInt(scope.totalPages)+1:scope.totalPages,scope.sg_currentPage=scope.totalPages<scope.sg_currentPage?scope.totalPages:scope.sg_currentPage,scope.soft_pages=[],scope.soft_pages.push({text:"<span class='fa fa-chevron-left'></span>",value:-1,active:!1}),1<scope.totalPages&&scope.soft_pages.push({text:"1..",value:1,active:1===scope.sg_currentPage});for(var e=scope.sg_currentPage,o=2;o<scope.totalPages;o++){var s=o==e;(o<e+3||e<=3&&o<=6)&&(3<=e&&e-3<o||e<=3&&o<=5||3<=e&&e<=o&&o<=e-3||e>=scope.totalPages-3&&o>=scope.totalPages-5||e<=3&&o<=6)&&scope.soft_pages.push({text:o,value:o,active:s})}scope.soft_pages.push({text:".."+scope.totalPages,value:scope.totalPages,active:scope.sg_currentPage===scope.totalPages}),scope.soft_pages.push({text:"<span class='fa fa-chevron-right'></span>",value:0,active:!1})}}function maskEmail(e){return"<a href='mailto:"+e+"'><span class='fa fa-envelope-o'></span> "+e+"</a>"}function maskPhone(e){return e=(e=(e=e.replace(/\D/g,"")).replace(/^(\d{2})(\d)/g,"($1) $2")).replace(/(\d)(\d{4})$/,"$1-$2")}function removerCaracteresInvalidos(e){return e.replace("\\","").replace('"',"").replace("“","").replace("”","").replace("‘","").replace("’","").replace("º","").replace("–","")}function _configurarRedimensionarColuna(){$(".softgrid th").mousedown(function(e){scope.elementoRedimensionado=$(this),scope.redimensionandoColuna=!0,scope.posicaoElementoX=e.pageX,scope.larguraElementoX=$(this).width()}),$(document).mousemove(function(e){scope.redimensionandoColuna&&$(scope.elementoRedimensionado).width(scope.larguraElementoX+(e.pageX-scope.posicaoElementoX))}),$(document).mouseup(function(){scope.redimensionandoColuna&&(scope.redimensionandoColuna=!1,scope.$apply())})}function _obterColuna(e){return scope.sg_cols[e]}function _obterLinha(e){return scope.showData[e]}function _hookDropDown(){$(".softgrid-container .dropdown").on("click",function(){var e=$(this),o=e.offset().top,s=$(this).height(),a=e.find(".dropdown-menu"),t=$(this).find(".btn").offset().left,n=$(window).scrollTop();a.css("top",o+s-n),a.css("left",t)}),$(window).scroll(function(){var e=$(".softgrid .dropdown.open");if(0<e.length){var o=e.find(".dropdown-menu"),s=$(this).scrollTop();o.css("top",e.offset().top+e.height()-s)}})}scope.sg_changePage=function(e){enableLog&&console.log("sg_changePage"),-1===e&&1<scope.sg_currentPage?scope.sg_currentPage=scope.sg_currentPage-1:-1===e&&1===scope.sg_currentPage?scope.sg_currentPage=scope.totalPages:0===e&&scope.sg_currentPage===scope.totalPages?scope.sg_currentPage=1:0===e&&scope.sg_currentPage<scope.totalPages?scope.sg_currentPage=scope.sg_currentPage+1:scope.sg_currentPage=e,_atualizarPaginacao(),_getFilteredData()},scope.sg_changeLinesPerPage=function(e){(-1===e&&10<scope.sg_linesPerPageInput||1===e)&&(scope.sg_linesPerPageInput=scope.sg_linesPerPageInput+10*e),enableLog&&console.log("sg_changeLinesPerPage")},scope.sg_sort=function(e,o,s){if(enableLog&&console.log("sg_sort"),!angular.isUndefined(scope.filteredData)){if(0<scope.filteredData.length){if(null!==scope.sg_orderBy&&scope.sg_orderByColIndex===o&&scope.reverse&&!s)return scope.sg_orderBy=null,scope.reverse=!1,scope.sg_orderByColIndex=-1,firstLoad||_saveStorage(),void _renderizarTabela();s||(null!==scope.sg_orderBy&&scope.sg_orderByColIndex!==o&&(scope.reverse=!1),null!==scope.sg_orderBy&&scope.sg_orderByColIndex===o&&(scope.reverse=!0)),scope.sg_orderByColIndex=o,scope.filteredData=$filter("orderBy")(scope.filteredData,e.item,scope.reverse),scope.sg_orderBy=e.item,firstLoad||_saveStorage()}_atualizarPaginacao(),_renderizarTabela()}},scope.sg_mask=function(e,o){return"phone"===e?maskPhone(o):"mail"===e?maskEmail(o):"date"===e?$filter("date")(o,"dd/MM/yyyy"):o},scope.sg_selectAll=function(){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_selected=!scope.sg_selected,angular.forEach(scope.filteredData,function(e){scope.sgControls.select.item&&(e[scope.sgControls.select.item]=scope.sg_selected)}),scope.sgControls.select.callback(scope.filteredData))},scope.sg_checkAll=function(o){scope.filteredData&&0<scope.filteredData.length&&(scope.sg_checked=!scope.sg_checked,angular.forEach(scope.filteredData,function(e){scope.sg_cols[o].item&&(e[scope.sg_cols[o].item]=scope.sg_checked)}),scope.sg_cols[o].callback(scope.filteredData),_renderizarTabela())},scope.sg_checkCol=function(e,o){e.checked=!e.checked,o.stopPropagation(),_getFilteredData()},scope.sg_hook=function(){_atualizarPaginacao(),_hookDropDown()},scope.exportExcel=function(){for(var e=createTable(),o=new Array(e.length),s=0;s<e.length;s++)o[s]=e.charCodeAt(s);var a=new Uint8Array(o),t=new Blob([a],{type:"data:application/vnd.ms-excel"}),n=document.createElement("a");n.setAttribute("href",URL.createObjectURL(t)),n.setAttribute("download",(new Date).toLocaleString()+".xls"),document.body.appendChild(n),n.click(),document.body.removeChild(n)},scope.exportarPDF=function(){var a=new jsPDF({unit:"px",format:"a4",orientation:"landscape"}),e=scope.sg_linesPerPage,t=1,o=0,s=scope.data.length/e,n=a.internal.pageSize.getWidth(),r=a.internal.pageSize.getHeight(),c=10;scope.obterLarguraColunas();for(var l=0;l<scope.data.length;l++)0!=o&&t!=e||((t=1)<++o&&a.addPage(),a.setFontSize(7.5),a.text("Página "+o+" de "+s,n-50,r-10),c=10,angular.forEach(scope.sg_cols,function(e){if(console.log(e.type),scope.validarColunaImpressao(e)){var o=4*e.larguraDinamica;a.setFontSize(10),a.text(e.title,c+5,10,{maxWidth:o+"px"}),c+=o}})),c=10,angular.forEach(scope.sg_cols,function(e){if(scope.validarColunaImpressao(e)){var o=4*e.larguraDinamica;a.setFontSize(10);var s=angular.isFunction(e.item)?e.item(scope.data[l]):scope.data[l][e.item];s=angular.isDefined(s)?s.toString():"n/a",a.text(s,c+5,10+10*t,{maxWidth:o+"px"}),c+=o}}),t++;a.save((new Date).toLocaleString()+".pdf")},scope.obterLarguraColunas=function(){angular.forEach(scope.sg_cols,function(a){a.larguraDinamica=a.title.length,angular.forEach(scope.data,function(e){var o,s=0;(o=angular.isFunction(a.item)?a.item(e):e[a.item])&&(s=o.toString().length),s>a.larguraDinamica&&(a.larguraDinamica=s)})})},scope.validarColunaImpressao=function(e){return"action"!=e.type&&"subgrid"!=e.type&&"menu"!=e.type&&"checkbox"!=e.type&&"select"!=e.type},scope.redimensionandoColuna=!1,scope.elementoRedimensionado=void 0,scope.posicaoElementoX=0,scope.larguraElementoX=0,scope.sg_edit=function(e){if(null!==scope.sg_editandoColunaValor&&""!==scope.sg_editandoColunaValor){var o=_obterColuna(scope.sg_editandoColunaIndex);scope.showData[scope.sg_editandoLinhaIndex][o.edit.item]=scope.sg_editandoColunaValor,o.edit.function(_obterLinha(scope.sg_editandoLinhaIndex))}scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,_renderizarTabela()},scope.sg_editandoColuna=!1,scope.sg_editandoColunaValor=null,scope.sg_editandoLinhaIndex=0,scope.sg_editandoColunaIndex=0,scope.sg_openEdit=function(e,o,s){if(!scope.sg_editandoColuna){scope.sg_editandoColuna=!0,scope.sg_editandoColunaIndex=e,scope.sg_editandoLinhaIndex=o,scope.sg_editandoValor=scope.sg_cols[e].item(scope.showData[o]);var a=s.currentTarget,t="<input id='sg_edit_input' class='edit-input' ng-model='sg_editandoColunaValor' ng-blur='sg_edit(this)' tooltip data-toggle='tooltip' data-placement='top' title='Digite o novo valor. Valor atual: "+scope.sg_editandoValor+"'style='color: black !important; width: "+scope.sg_cols[e].edit.width+";'>";angular.element(a).append($compile(t)(scope)),$(a).find("label").css("display","none");var n=$("#sg_edit_input");$timeout(function(){""!==n.value?n.select():n.focus()},200)}},$timeout(_configurarRedimensionarColuna,500),scope.$watch("showData",function(e,o){$timeout(_renderizarTabela,200)},!0),scope.$watch("data",function(){enableLog&&console.log("dataWatcher"),_getFilteredData(),scope.sg_orderBySaved&&(scope.sg_orderByColIndex=-1,angular.isDefined(scope.sg_orderBySaved)&&scope.sg_sort(scope.sg_orderBySaved,scope.sg_orderByColIndexSaved,!0)),scope.data&&0<scope.data.length&&(firstLoad?(scope.sgStore&&_loadStorage(),firstLoad=!1):scope.sg_currentPage=1),_atualizarPaginacao()}),scope.$watch("sg_linesPerPageInput",function(){enableLog&&console.log("linesPerPageInputWatcher"),0<scope.sg_linesPerPageInput&&(scope.sg_linesPerPage=parseInt(scope.sg_linesPerPageInput),firstLoad||_saveStorage(),_getFilteredData())}),scope.$watch("sgControls",function(){enableLog&&console.log("sgControlsWatcher"),angular.isDefined(scope.sgControls)&&scope.sgControls&&(scope.sgControls.checkAll=scope.sg_checkAll,scope.sgControls.create&&(scope.larguraColunaControles+=60),scope.sgControls.read&&(scope.larguraColunaControles+=60),scope.sgControls.update&&(scope.larguraColunaControles+=60),scope.sgControls.delete&&(scope.larguraColunaControles+=60))}),scope.$watch("hide",function(){enableLog&&console.log("hideWatcher"),scope.hide&&(!0!==scope.hide.pagination&&!0!==scope.hide.all||(scope.sg_linesPerPage=999))}),scope.$watch("subgrid",_calcularTamanhoColunaAcoes),scope.$watch("actions",_calcularTamanhoColunaAcoes),scope.$watch("sg_currentPage",function(){enableLog&&console.log("currentPageWatcher"),firstLoad||_saveStorage()}),scope.$watch("sg_filter",function(){enableLog&&console.log("filterWatcher"),scope.sg_changePage(1)}),scope.$watch("filteredData",function(){scope.linhaSelecionadaIndex=null});var flagCol=!0;function _controlesParaColunas(){var e=[];if(angular.isDefined(scope.cols)&&0<scope.cols.length){if(scope.sgControls&&scope.sgControls.checkBox&&e.push({type:"checkbox",title:"Selecionar",callback:scope.sgControls.checkBox.function,item:scope.sgControls.checkBox.item}),scope.subgrid&&e.push({type:"subgrid",title:"Detalhes",item:scope.subgrid.item,cols:scope.subgrid.cols,menu:scope.subgrid.actions,hide:scope.subgrid.hide,subgrid:scope.subgrid.subgrid}),scope.actions&&0<scope.actions.length){var o={type:"menu",title:"Opções",menu:scope.actions};angular.isDefined(scope.sgControls)&&angular.isDefined(scope.sgControls.showAction)&&(o.showRow=scope.sgControls.showAction),e.push(o)}scope.sgControls&&(scope.sgControls.create&&e.push({type:"action",title:scope.sgControls.create.title?scope.sgControls.create.title:"Criar",callback:scope.sgControls.create.action,icon:scope.sgControls.create.icon?scope.sgControls.create.icon:"fa-plus"}),scope.sgControls.read&&e.push({type:"action",title:scope.sgControls.read.title?scope.sgControls.read.title:"Ver",callback:scope.sgControls.read.action,icon:scope.sgControls.read.icon?scope.sgControls.read.icon:"fa-search"}),scope.sgControls.update&&e.push({type:"action",title:scope.sgControls.update.title?scope.sgControls.update.title:"Criar",callback:scope.sgControls.update.action,icon:scope.sgControls.update.icon?scope.sgControls.update.icon:"fa-pencil"}),scope.sgControls.delete&&e.push({type:"action",title:scope.sgControls.delete.title?scope.sgControls.delete.title:"Criar",callback:scope.sgControls.delete.action,icon:scope.sgControls.delete.icon?scope.sgControls.delete.icon:"fa-trash"})),e=e.concat(scope.cols),scope.sgControls&&scope.sgControls.active&&e.push({type:"switch",title:scope.sgControls.activeTitle?scope.sgControls.activeTitle:"Ativo",item:scope.sgControls.activeCol,callback:scope.sgControls.activeFunction}),scope.sgControls&&scope.sgControls.favorite&&e.push({type:"favorite",title:"Favorito",item:scope.sgControls.favorite.item,callback:scope.sgControls.favorite.function,showRow:scope.sgControls.favorite.show}),scope.sgControls&&scope.sgControls.progress&&e.push({type:"progress",title:"Progresso",class:scope.sgControls.progress.class,item:scope.sgControls.progress.item}),scope.sgControls&&scope.sgControls.approve&&scope.sgControls.approve.showCol&&e.push({type:"approve",title:"Aprovação",showCol:scope.sgControls.approve.showCol,showRow:scope.sgControls.approve.show,callback:scope.sgControls.approve.callback}),flagCol&&(scope.cols=e,scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),flagCol=!1),_getFilteredData()}}function _calcularTamanhoColunaAcoes(){scope.larguraColunaAcoes=0,scope.subgrid&&(scope.larguraColunaAcoes+=60),scope.actions&&0<scope.actions.length&&(scope.larguraColunaAcoes+=60)}function _saveStorage(){if(scope.sgStore&&scope.sgStore.enabled){var e={};e.linesPerPage=scope.sg_linesPerPage,e.currentPage=scope.sg_currentPage,null!==scope.sg_orderBy?(e.orderBy={item:scope.sg_orderBy.toString(),reverse:scope.reverse,index:scope.sg_orderByColIndex},scope.sg_orderByColIndexSaved=e.orderBy.index,scope.sg_orderBySaved={item:scope.sg_orderBy}):(scope.sg_orderBySaved=null,scope.sg_orderByColIndexSaved=null);var o=[],s=0;angular.forEach(scope.sg_cols,function(e){o.push({col:removeAccents(e.title).replace(" ",""),index:s}),s++}),e.cols=o,localStorage.setItem("SG-STORE_"+scope.sgStore.id,angular.toJson(e)),enableLog&&console.log("_saveStorage")}}function _loadStorage(){if(scope.sgStore&&scope.sgStore.enabled){var _properties=angular.fromJson(localStorage.getItem("SG-STORE_"+scope.sgStore.id));if(_properties){if(scope.sg_linesPerPage=scope.sg_linesPerPageInput=_properties.linesPerPage,scope.sg_currentPage=_properties.currentPage,_properties.orderBy&&""!==_properties.orderBy.item){var _item={item:eval("("+_properties.orderBy.item+")")};scope.sg_orderByColIndexSaved=_properties.orderBy.index,scope.sg_orderBySaved=_item,scope.reverse=_properties.orderBy.reverse,scope.sg_sort(_item,_properties.orderBy.index,!0)}if(_properties.cols){_controlesParaColunas();var _colunas=[],_limpar=!1;angular.forEach(_properties.cols,function(o){var e=scope.cols.filter(function(e){return removeAccents(e.title).replace(" ","")===o.col})[0];e?_colunas.push(e):_limpar=!0}),scope.sg_cols=_colunas,_limpar&&scope.limparConfiguracaoColuna(),_getFilteredData()}enableLog&&console.log("_loadStorage"),_atualizarPaginacao()}}}function _alterarColunas(o,s){var a=[],t={};angular.forEach(scope.cols,function(e){removeAccents(e.title).replace(" ","")===s&&(t=e)}),angular.forEach(scope.sg_cols,function(e){removeAccents(e.title).replace(" ","")===o&&a.push(t),removeAccents(e.title).replace(" ","")!==s&&a.push(e)}),scope.sg_cols=a,_saveStorage(),_getFilteredData()}function _renderizarTabela(){enableLog&&console.log("_renderizarTabela"),$(scope.container).html(""),$(scope.configuration).html("");var c=!1,l=[];l.push("<div style='"+(scope.width?"width:"+scope.width+"px":"width: 100%")+"'>"),l.push("<table width='100%' "+(scope.subgrid?"id='softgrid'":"")+" class='softgrid "+scope.template+"'>"),l.push("<thead>");var o=0;angular.forEach(scope.sg_cols,function(e){l.push("<th id='sg_col_"+removeAccents(e.title).replace(" ","")+"' class='softgrid-th-drop'>"),l.push("<span class='fa fa-arrow-left'></span>"),l.push("<span class='title' ng-click='sg_sort(sg_cols["+o+"], "+o+")'>"),l.push(e.title),o===scope.sg_orderByColIndex&&l.push("<span class='fa "+(scope.reverse?"fa-sort-amount-desc":"fa-sort-amount-asc")+"'></span>"),l.push("</span>"),"checkbox"===e.type&&l.push("<input style='margin: 0px 0px 0px 5px;' type='checkbox' "+(scope.sg_checked?"checked":"")+" ng-click='sg_checkAll("+o+")'>"),scope.configuracaoAberta&&l.push("<span class='fa fa-times pull-right' ng-click='removerColuna(sg_cols["+o+"])'></span>"),l.push("</th>"),o++}),l.push("</thead>"),l.push("<tbody>"),scope.showData=$filter("limitTo")(scope.filteredData,scope.sg_linesPerPage,scope.sg_currentPage*scope.sg_linesPerPage-scope.sg_linesPerPage);var i=0;angular.forEach(scope.showData,function(n){var e="";scope.sgControls&&(scope.sgControls.changeRowColor&&"string"==typeof scope.sgControls.rowColor?!0===scope.sgControls.changeRowColor(n)&&(e="style='background-color: "+scope.sgControls.rowColor+"'"):angular.isDefined(scope.sgControls.rowColor)&&(e="style='background-color: "+scope.sgControls.rowColor(n)+"'")),l.push("<tr id='sg_linha_"+i+"' ng-click='sg_selecionarLinha("+i+")' class='soft-row "+(i%2?"soft-row-striped":"")+(scope.linhaSelecionadaIndex,"")+"' "+e+">");var r=0;angular.forEach(scope.sg_cols,function(o){var e="text"!==o.type&&"html"!==o.type&&angular.isDefined(o.type)?"text-align: center;":"";o.width="text"!==o.type&&"html"!==o.type&&angular.isDefined(o.type)&&angular.isUndefined(o.width)?"110px;":o.width;var s=o.style?o.style(n):"";if(l.push("<td style='"+s+e+(o.width?"width: "+o.width:"")+"'>"),angular.isUndefined(o.type)||"text"===o.type||"html"===o.type||"date"===o.type){var a=o.edit?"title='Clique aqui para editar' ng-click='sg_openEdit("+r+", "+i+", $event)'":"";l.push("<div "+a+" style='"+(o.align?"text-align: "+o.align+";":"text-align: left;")+"'>"),o.popOver?l.push("<label style='text-decoration: underline; cursor: pointer' popover data-toggle='popover' data-trigger='hover' data-content='"+o.item(n)+"'>"+$filter("limitTo")(o.item(n),o.maxLength?o.maxLength:999)+"</label>"):(l.push("<label style='width: 100%; "+s+"'>"),angular.isFunction(o.click)&&l.push("<a style='color: #f39c12; cursor: pointer; font-weight: bold' ng-click='sg_cols["+r+"].click(showData["+i+"])'>"),l.push(scope.sg_mask(o.type,o.item(n))),angular.isFunction(o.click)&&l.push("</a>"),l.push("</label>"))}else if("checkbox"===o.type)l.push("<input type='checkbox' ng-click='sg_cols["+r+"].callback(showData["+i+"])' "+(n[scope.sg_cols[r].item]?"checked":"")+">");else if("subgrid"===o.type)l.push("<button type='button' class='btn btn-default btn-sm btn-subgrid' ng-click='abrirSubGrid("+r+","+i+")'>"),l.push("<span class='fa "+(scope.showSubGrid?"fa-compress":"fa-expand")+"'></span></button>"),c=!0;else if("menu"===o.type){if(angular.isDefined(o.showRow)&&!o.showRow(n))return void r++;l.push("<div class='dropdown'>"),l.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),l.push("<span class='fa fa-bars'></span></button>"),l.push("<ul class='dropdown-menu dropdown-menu-left'>");var t=0;angular.forEach(o.menu,function(e){(!angular.isDefined(e.show)||e.show(n))&&(l.push("<li>"),l.push("<a ng-click='sg_cols["+r+"].menu["+t+"].function(showData["+i+"])'><span class='"+e.icon+"'></span>  "+e.title+"</a>"),l.push("</li>")),t++}),l.push("</ul></div>")}else if("action"===o.type)l.push("<button class='btn btn-default btn-sm' ng-click='sg_cols["+r+"].callback(showData["+i+"])' title='"+o.title+"'>"),l.push("<span class='fa "+o.icon+"'></span></button>");else if("switch"===o.type)l.push("<label class='switch'>"),l.push("<input type='checkbox' ng-click='sg_cols["+r+"].callback(showData["+i+"])' "+(scope.sg_cols[r].item(n)?"checked":"")+">"),l.push("<div class='slider round'></div>"),l.push("</label>");else if("favorite"===o.type){if(angular.isDefined(o.show)&&!o.show(n))return void r++;l.push("<span class='fa fa-star "+(o.item(n)?"active":"")+"' ng-click='sg_favoritar("+r+", "+i+")'></span>")}else if("progress"===o.type)l.push("<div class='progress'>"),l.push("<div class='progress-bar "+(o.class?o.class(n):"")+"' role='progressbar' style='width: "+o.item(n)+"%;'>"),l.push(o.item(n)+"%</div></div>");else if("approve"===o.type){if(!o.showCol(n)||!o.showRow(n))return void r++;l.push("<button title='Aprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+r+"].callback(showData["+i+"], true)'><span class='fa fa-thumbs-up'></span></button>"),l.push("<button title='Reprovar' class='btn btn-default btn-sm' ng-click='sg_cols["+r+"].callback(showData["+i+"], false)'><span class='fa fa-thumbs-down'></span></button>")}else if("select"===o.type){l.push("<div class='dropdown softgrid-dropdown-container'>"),l.push("<button type='button' class='btn btn-default btn-sm dropdown-toggle softgrid-dropdown' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>"),l.push("<span class='fa fa-caret-down'></span>"+scope.showData[i][scope.sg_cols[r].item][scope.sg_cols[r].field.text]+"</button>"),l.push("<ul class='dropdown-menu dropdown-menu-left'>");t=0;angular.forEach(o.data,function(e){l.push("<li>"),l.push("<a ng-click='sg_select("+r+", "+i+", "+t+")'> "+e[o.field.text]+"</a>"),l.push("</li>"),t++}),l.push("</ul></div>")}l.push("</div></td>"),r++}),l.push("</tr>"),c&&(l.push("<tr style='display: none' class='"+(i%2?"soft-row-striped":"")+"'>"),l.push("<td id='sg_subgrid_"+i+"' colspan='"+scope.sg_cols.length+"'>"),l.push("</td>"),l.push("</tr>")),i++}),angular.isDefined(scope.showData)&&scope.showData.length<=0&&l.push("<tr><td style='text-align: center;' colspan='"+scope.sg_cols.length+"'>Não há dados a serem exibidos.</td></tr>"),l.push("</tbody>"),l.push("</table>"),l.push("</div>"),angular.element(scope.container).append($compile(l.join(""))(scope));var s="<h5><label class='label label-primary'>Customizar Colunas</label></h5>",a=!0;angular.forEach(scope.cols,function(o){var e=scope.sg_cols.filter(function(e){return e.title===o.title});(!1===o.default&&e.length<=0||(angular.isUndefined(o.default)||!0===o.default)&&e.length<=0)&&(s+="<div id='sg_col_"+removeAccents(o.title).replace(" ","")+"' class='softgrid-configuration-col'>"+o.title+"</div>",a=!1)}),a&&(s+="<small>Todas as colunas estão sendo exibidas.</small>"),s+="<a href='javascript:void(0)' ng-click='limparConfiguracaoColuna()'>Limpar alterações</a>",angular.element(scope.configuration).append($compile(s)(scope)),scope.configuracaoAberta&&(_configurarDrop(),_configurarDrag()),_hookDropDown()}function _configurarDrag(){angular.forEach($(scope.configuration).find(".softgrid-configuration-col"),function(e,o){var s=angular.element(e);"true"!==s.attr("draggable")&&(s.attr("draggable","true"),s.on("dragstart",_aoArrastarTarefa),s.on("dragend",_aoPararArrastarTarefa))})}function _aoArrastarTarefa(e){e.dataTransfer?e.dataTransfer.setData("Text",e.target.id):e.originalEvent.dataTransfer.setData("Text",e.target.id)}function _aoPararArrastarTarefa(e){}function _configurarDrop(){angular.forEach($(scope.container).find(".softgrid-th-drop"),function(e,o){var s=angular.element(e);s.hasClass("softgrid-th-drop")&&"true"!==s.attr("draggable")&&(s.attr("draggable","true"),s.on("dragstart",_aoArrastarTarefa),s.on("dragover",function(e){e.preventDefault()}),s.on("dragenter",function(e){$(e.target).addClass("active")}),s.on("dragleave",function(e){$(e.target).removeClass("active")}),s.on("drop",_aoDroparTarefa))})}function _aoDroparTarefa(e){e.preventDefault();var o="";o=e.dataTransfer?e.dataTransfer.getData("Text").replace("sg_col_",""):e.originalEvent.dataTransfer.getData("Text").replace("sg_col_",""),_alterarColunas(e.target.id.replace("sg_col_",""),o)}scope.$watch("cols",function(){enableLog&&console.log("colsWatcher"),_controlesParaColunas()}),scope.abrirConfiguracao=function(){scope.configuracaoAberta=!scope.configuracaoAberta,scope.configuracaoAberta?($(scope.configuration).css("width","200px"),$(scope.configuration).css("border","1px solid #ccc"),$(scope.container).css("min-height","300px"),_getFilteredData()):($(scope.configuration).css("width","0"),$(scope.configuration).css("border","0"),$timeout(function(){$(scope.container).css("min-height","0")},500),_getFilteredData(),_configurarRedimensionarColuna())},scope.removerColuna=function(o){scope.sg_cols=scope.sg_cols.filter(function(e){return e.title!==o.title}),_saveStorage(),_getFilteredData()},scope.sg_selecionarLinha=function(e){angular.isDefined(scope.linhaSelecionadaIndex)&&$("#sg_linha_"+scope.linhaSelecionadaIndex).removeClass("active"),scope.linhaSelecionadaIndex=e,$("#sg_linha_"+e).addClass("active")},scope.sg_select=function(e,o,s){scope.sg_cols[e].callback(scope.showData[o],scope.sg_cols[e].data[s]),scope.showData[o][scope.sg_cols[e].item][scope.sg_cols[e].field.text]=scope.sg_cols[e].data[s][scope.sg_cols[e].field.text],scope.showData[o][scope.sg_cols[e].item][scope.sg_cols[e].field.value]=scope.sg_cols[e].data[s][scope.sg_cols[e].field.value]},scope.sg_favoritar=function(e,o){scope.sg_cols[e].callback(scope.showData[o]),$timeout(_renderizarTabela,1e3)},scope.limparConfiguracaoColuna=function(){scope.sg_cols=scope.cols.filter(function(e){return angular.isUndefined(e.default)||!0===e.default}),_saveStorage(),_renderizarTabela()},scope.abrirSubGrid=function(e,o){if($("#sg_subgrid_"+o).hasClass("active"))$("#sg_subgrid_"+o).html(""),$("#sg_subgrid_"+o).removeClass("active"),$($("#sg_subgrid_"+o).parent()).css("display","none");else{var s=[];s.push("<div class='soft-subgrid-container'>"),s.push("<softgrid cols='sg_cols["+e+"].cols' actions='sg_cols["+e+"].menu' data='sg_cols["+e+"].item(showData["+o+"])' hide='sg_cols["+e+"].hide' sg-controls='sg_cols["+e+"].controls' subgrid='sg_cols["+e+"].subgrid' template=\"'soft-subgrid'\"></softgrid>"),s.push("</div>"),angular.element($("#sg_subgrid_"+o)).append($compile(s.join(""))(scope)),$("#sg_subgrid_"+o).addClass("active"),$($("#sg_subgrid_"+o).parent()).css("display","table-row")}}}}}angular.module("softgrid.directive",["base64"]).directive("softgrid",softGrid),softGrid.$injector=["$filter","$base64","$timeout","$compíle"],angular.module("softgrid.directive").directive("popover",function(){return function(e,o){$(o).popover()}}),angular.module("softgrid.directive").directive("tooltip",function(){return function(e,o){$(o).tooltip()}})}(),angular.module("softgrid.directive").run(["$templateCache",function(e){e.put("softgrid.html",'\r\n<div class="softgrid-display" ng-class="{\'softgrid-display-fullscreen\': softgrid.fullscreen}" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': sgControls.fullscreen.zindex, \'top\': sgControls.fullscreen.top + \'px\'} : \'\'">\r\n\r\n    <div class="grid-controles" ng-style="sgControls.fullscreen && softgrid.fullscreen ? { \'z-index\': (sgControls.fullscreen.zindex + 1), \'top\': (sgControls.fullscreen.top) + \'px\'} : \'\'">\r\n\r\n        <div class="row" ng-hide="hide.all">\r\n\r\n            <div class="col-md-2">\r\n\r\n                <div ng-hide="hide.filter || hide.all">\r\n\r\n                    <label>Filtrar</label>\r\n\r\n                    <div class="input-group">\r\n\r\n                        <div class="input-group-btn">\r\n\r\n                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-search"></span></button>\r\n\r\n                            <ul class="dropdown-menu dropdown-menu-left">\r\n\r\n                                <li ng-repeat="col in cols track by $index">\r\n\r\n                                    <a ng-click="sg_checkCol(col, $event)"> <input type="checkbox" ng-checked="col.checked" ng-click="sg_checkCol(col, $event)" /> {{col.title}} </a>\r\n\r\n                                </li>\r\n\r\n                            </ul>\r\n\r\n                        </div>\r\n\r\n                        <input type="text" class="form-control" ng-model="sg_filter" placeholder="Palavra-chave" aria-describedby="filtro-addon">\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-6">\r\n\r\n                <div class="row">\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div class="form-group" ng-hide="hide.linesPage || hide.all || hide.pagination" style="margin-bottom: 0;">\r\n\r\n                            <label>Linhas por página</label>\r\n\r\n                            <div class="input-group" style="width: 120px;">\r\n\r\n                        <span class="input-group-btn">\r\n                            <button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(-1)">-</button>\r\n                        </span>\r\n\r\n                                <input class="form-control" ng-model="sg_linesPerPageInput">\r\n\r\n                                <span class="input-group-btn">\r\n\t\t\t\t\t\t\t<button class="btn btn-default" type="button" ng-click="sg_changeLinesPerPage(1)">+</button>\r\n\t\t\t\t\t\t</span>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div ng-hide="hide.options || hide.all">\r\n\r\n                            <label>Opções</label>\r\n\r\n                            <div class="input-group">\r\n\r\n                                <input type="text" class="form-control" aria-label="..." value="{{filteredData.length}} encontrado(s)" disabled="true">\r\n\r\n                                <div class="input-group-btn">\r\n\r\n                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\r\n\r\n                                    <ul class="dropdown-menu dropdown-menu-right">\r\n\r\n                                        <li ng-repeat="item in sgMenu">\r\n                                            <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\r\n                                        </li>\r\n\r\n                                        <li role="separator" class="divider" ng-show="sgMenu"></li>\r\n\r\n                                        <li ng-if="sgControls.select"><a ng-click="sg_selectAll()"><span class="fa fa-check"></span> Selecionar Todos</a></li>\r\n\r\n                                        <li><a ng-click="exportExcel()"><span class="fa fa-file-excel-o"></span> Exportar Excel</a></li>\r\n\r\n                                        <li><a ng-click="exportarPDF()"><span class="fa fa-file-pdf-o"></span> Exportar PDF</a></li>\r\n\r\n                                    </ul>\r\n\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div class="col-md-4">\r\n\r\n                        <div ng-hide="hide.fullscreen || hide.all">\r\n\r\n                            <label>&nbsp;</label><br>\r\n                            <button class="btn btn-default" ng-click="softgrid.fullscreen = softgrid.fullscreen ? false : true"><span class="fa fa-expand" ng-class="{\'fa-compress\': softgrid.fullscreen}"></span>\r\n\r\n                                {{ softgrid.fullscreen ? (sgControls.fullscreen.on ? sgControls.fullscreen.on : \'Tela normal\') : (sgControls.fullscreen.off ? sgControls.fullscreen.off : \'Tela cheia\') }}\r\n\r\n                            </button>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n            <div class="col-md-4">\r\n\r\n                <nav aria-label="Page navigation" class="pull-right" ng-hide="hide.pagination || hide.all">\r\n\r\n                    <label>Paginação</label>\r\n\r\n                        <ul class="pagination">\r\n\r\n                            <li ng-repeat="soft_page in soft_pages" ng-class="{\'active\': soft_page.active}">\r\n                                <a ng-click="sg_changePage(soft_page.value)" ng-bind-html="soft_page.text"></a>\r\n                            </li>\r\n\r\n                            <li ng-if="sgStore" title="Editar Colunas" ng-click="abrirConfiguracao()"><span class="fa fa-pencil"></span></li>\r\n                            \r\n                            \x3c!-- <div class="input-group-btn">\r\n                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="fa fa-bars"></span></button>\r\n                                <ul class="dropdown-menu dropdown-menu-right">\r\n                                    <li ng-repeat="item in sgMenu">\r\n                                        <a ng-click="item.function()"><span class="{{item.icon}}"></span> {{item.title}}</a>\r\n                                    </li>\r\n                                    <li role="separator" class="divider" ng-show="sgMenu"></li>\r\n                                    <li ng-if="sgControls.select"><a ng-click="sg_selectAll()"><span class="fa fa-check"></span> Selecionar Todos</a></li>\r\n                                    <li><a ng-click="softGridToExcel()"><span class="fa fa-file-excel-o"></span> Gerar Excel</a></li>\r\n                                </ul>\r\n                            </div> --\x3e\r\n                        </ul>\r\n\r\n                </nav>\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row">\r\n\r\n        <div class="col-md-12">\r\n\r\n            <div class="softgrid-configuration scrolls">\r\n\r\n\r\n            </div>\r\n\r\n            <div class="softgrid-container">\r\n\r\n\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="row" ng-hide="hide.pagination || hide.all">\r\n\r\n        <div class="col-md-12">\r\n\r\n            <nav aria-label="...">\r\n                <ul class="pager" style="margin-top: 5px;">\r\n                    <li class="previous"><button class="btn btn-default pull-left" ng-click="sg_changePage(-1)"><span aria-hidden="true">&larr;</span> Página anterior</button></li>\r\n                    <li class="next"><button class="btn btn-default pull-right" ng-click="sg_changePage(0)">Próxima página <span aria-hidden="true">&rarr;</span></button></li>\r\n                </ul>\r\n            </nav>\r\n\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div class="modal-loading" ng-if="loading">\r\n\r\n        <div class="lds-dual-ring"></div>\r\n\r\n    </div>\r\n\r\n</div>\r\n\r\n')}]);